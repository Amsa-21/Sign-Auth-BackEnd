from cryptography.x509 import (
  Name, NameAttribute, CertificateBuilder, KeyUsage, SubjectAlternativeName, RFC822Name, random_serial_number
)
from cryptography.hazmat.primitives.serialization import pkcs12, PrivateFormat
from cryptography.hazmat.primitives import hashes, serialization
from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.backends import default_backend
from cryptography.x509.oid import NameOID
import datetime, random, base64

def generate_certificate(EMAIL_ADDRESS, ORGANIZATION_NAME, COMMON_NAME):
  private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,
    backend=default_backend()
  )
  public_key = private_key.public_key()

  digit = random.randint(000000, 999999)
  
  subject = Name([
    NameAttribute(NameOID.EMAIL_ADDRESS, EMAIL_ADDRESS),
    NameAttribute(NameOID.COUNTRY_NAME, "SN"),
    NameAttribute(NameOID.ORGANIZATION_NAME, ORGANIZATION_NAME),
    NameAttribute(NameOID.ORGANIZATIONAL_UNIT_NAME, "Confiance Numérique"),
    NameAttribute(NameOID.COMMON_NAME, COMMON_NAME),
  ])

  issuer = Name([
    NameAttribute(NameOID.COUNTRY_NAME, "SN"),
    NameAttribute(NameOID.ORGANIZATION_NAME, "AmsTech"),
    NameAttribute(NameOID.ORGANIZATIONAL_UNIT_NAME, "Confiance Numérique"),
    NameAttribute(NameOID.COMMON_NAME, "AmsTech SN"),
  ])
  
  bytes_img = b'\xff\xd8\xff\xe0\x00\x10JFIF\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\xff\xdb\x00C\x00\x02\x01\x01\x01\x01\x01\x02\x01\x01\x01\x02\x02\x02\x02\x02\x04\x03\x02\x02\x02\x02\x05\x04\x04\x03\x04\x06\x05\x06\x06\x06\x05\x06\x06\x06\x07\t\x08\x06\x07\t\x07\x06\x06\x08\x0b\x08\t\n\n\n\n\n\x06\x08\x0b\x0c\x0b\n\x0c\t\n\n\n\xff\xdb\x00C\x01\x02\x02\x02\x02\x02\x02\x05\x03\x03\x05\n\x07\x06\x07\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\xff\xc0\x00\x11\x08\x00\xa0\x00\xa0\x03\x01"\x00\x02\x11\x01\x03\x11\x01\xff\xc4\x00\x1f\x00\x00\x01\x05\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\xff\xc4\x00\xb5\x10\x00\x02\x01\x03\x03\x02\x04\x03\x05\x05\x04\x04\x00\x00\x01}\x01\x02\x03\x00\x04\x11\x05\x12!1A\x06\x13Qa\x07"q\x142\x81\x91\xa1\x08#B\xb1\xc1\x15R\xd1\xf0$3br\x82\t\n\x16\x17\x18\x19\x1a%&\'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\x83\x84\x85\x86\x87\x88\x89\x8a\x92\x93\x94\x95\x96\x97\x98\x99\x9a\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xff\xc4\x00\x1f\x01\x00\x03\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\xff\xc4\x00\xb5\x11\x00\x02\x01\x02\x04\x04\x03\x04\x07\x05\x04\x04\x00\x01\x02w\x00\x01\x02\x03\x11\x04\x05!1\x06\x12AQ\x07aq\x13"2\x81\x08\x14B\x91\xa1\xb1\xc1\t#3R\xf0\x15br\xd1\n\x16$4\xe1%\xf1\x17\x18\x19\x1a&\'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x92\x93\x94\x95\x96\x97\x98\x99\x9a\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xff\xda\x00\x0c\x03\x01\x00\x02\x11\x03\x11\x00?\x00\xfc\x98\xd1\xb4\xb3q0\xf30\x01>\x95\xdbi:\x1cP@\xaf\xe4\x86^\xd5\xccx}\xa4\x92UEBFy\xae\xdfO;-\x84N\xc0t\xafJ\x86\x1a+\xde<\xf9M-\xc9c\x89\x10a \xfc}*x/\x1a\x15\xc7\x9c9<\n\x8aW\x8dc\xe1\xb7\x1f\xadQ\x92ue;\x8f=\x805\xe9\xd3\x83\xe8b\xe4\xf76~\xdf\xbf(\xb2g\x1d\xaax5\x16\x03\xe7\xc9\xdb\xe9\\\xf4\x13\x04\x1f\xbbs\x9f\xad_\xb4\x99\x8anW\xc9\xad\xe3\x04\xf5d)F\xf74\xcd\xebM\x19\x08\xa7\x93Kmj\xef\xf3\xee\x03\xf1\xaa\xb6\xf9a\xef\xe9Z6v\xdf0\xf3\x13\x1e\xa6\xb6\x8cb\xb6\x1a\xbfB#\xa6\xccY\x94>H\x1c\x1cT\x96\xba<\xccI\x9b\xf0\xc0\xad\xfd?K\x17\nDc\x8fZ\xda\xd2\xfc9\x0b\x00\xb2\x06o\xadl\x93\x8a\xb9\x0b\xdevg/k\xa2F\xe4a\x08\x18\xebW\xe2\xd0\xd2?\x99"#\xd0z\xd7]i\xe1\xa8\xa0l\x81\x91\xe9\x8a\xb8t\x14\xc0\x11\xae\x0f^\x95I\xabl\\b\xafc\x8a\xfe\xc0y~\x7f$\xfb\xe6\xa2}\x06\x0c\xed\x95\n\x93\xde\xbb\xe4\xd1\xd1W\xf7\xb1\xe6\xab\xde\xe8\x8a\xeaLk\x81\xebY\xbb_T_\xb3l\xf3\xddK\xc3\x11\x05\xdc\xa7\x1e\xe0V\x15\xfe\x98l\xdf\x8c\x90k\xd1um\x1ah\xa1\xc4dm\xc75\xca\xea\xf0\xa6\xe3\x1a78\xf4\xa3s9C\x94\xe5f\x08\t\xdaF{\xe6\x96\x17\x8b\x00\x12\x0f=jk\x94\x89&1\x81\xcf\xa8\x15\t\\0 f\xb3qkFJmlIqci}\x1e\'\x83~\x01\xc15\xc5\xf8\xab\xc2\xd7\x1al\xe6\xf2\x04b\x85x\x18\xc8\x15\xdb\xc1!\x0e\x19\x8fN\xd4\xeb\xabh\xf5Kv\x8aq\x80\x07\x00\n\xe1\xc5\xe1UH]\x1d\x14\xeaY\x9c\x17\x87"1\xb0v`3\xd3\x15\xd2\tW\xcb\x00?\xe5\\g\x87\xaf\xe4\x9f\xf7;\xc8\xc7J\xe8\xed\xe6\x91\x13\x00n\xf7\xcd*v\x8cHrI\x96\xe6\x94\xbf\x01\xf1P\xae\xe7\xeaH\xed\x9c\xd2\x03+\x90\xee2>\xb54q\x02\xb8\xe9\x83\xd3\xaduA\xa6\xb5\xdc\xceRL!\x85\x01\xc1\x90\xfe&\xaf\xe9\xe0\x05\xc0\x00\xfb\xe6\xab\xc3fd\xceS\x15f+f\x8f\x90\xc7\xa68\xae\x8aj\xe6qm\xa3N\xc91\xf3\xaf>\xc6\xb64\xc3\x04\xac\x1aX\x85ei\xb2\xc7\xe5\xf9L\xdf05\xa5d\xa7\xccQ\x19\xc1\xcf\\V\xea\x97\x90\xf9\xa4u:$a\x99DhB\xfds]F\x95\t\x03-\x16W\xb7\x15\x85\xe1\xd8\xe4x\xd4H\xc3\x8fj\xebt\xebp\xc8\x01N\xbd\xe9\xb85\xa1\xa4Q*\x15\x008\x8c\xfd*M\xf1\x8eH\xe4\xf64\xf2\x9eX\xc2\xa0>\xe6\xab\xca\xa8\xaf\xbcd\x1fjN\x1c\xc6\xca\xc9\x0exIm\xe7\x18\xf4\xc5T\xba`\xdftc\x9e\xd5d\xbc\x92&6\x1c\xfa\x9a\x8eKu#\x00\x10\xc7\xfb\xd4\xd4m\xa1\\\xca\xc6.\xac\xceb+\x1cy\xe3\xbdq^!\x8fsd\xa69\xe8{W\x7f\xa8\xdb:B\xca\x83\x909\xaeOU\xd3G\xcc\x1e&9\xe9G\xb3\xbb\xba3\x93\xe6G\x03z\x9eL\xc4(\xeaj\xb3\xdd\xa8\xf9\x1cu\xadMgMt\x90\xeel\xe4\xf4\xf4\xac\x99-rH4\xa5\x0b\xees\xc9\xb8\xb1\xf1\xb9c\x95n\x95r\xd1\x0c\x8c\x0b\xf2:U(-\x80\'`\xc6*\xe5\x94%\x1c4\x98?\x8ds\xd5\x85\x95\x87\x19\xb4\xcf0\xd1\xe1Ep0F\x07\x06\xba\x1b\x13&\xccm\xc8\xef\xcdf@\x82\xdar\xd1\xc7\x80z\n\xb3\r\xd4\xb9\xf9[h\'\x91^~\x1d"\xdc\x9bf\xaeb\x1fz\xa7\xb7\xb7,C\xc7\xcf\xa8\xaa\x90\xdcBW\x0f!\'\xebV\xa3\xd5\xec\xa0\x8b\xcb2\xed\xfcz\xd7\xa5\x1a1\xdd\x99^\xfb\x1av\xd0K*\x85Q\x8fz\xb2\x9aD\x8e\x0e\xc5\xc9\xeeqY\x16\xde0\xd2\xed\x81C1\xfa\x9a\xbfo\xf1\x17I\x81\x02\x07\x07#\xd7\x15\xddM\xd2\xb6\xe5;\xd8\xd9\xb0\xd0\xa6]\xbb\xbf:\xe84\xdd%\x1e0~bs\xc9\x15\xca[|M\xf0\xfa\xb0F\x90d\x8cu\xad\x8b\x1f\x89\xda\x11\x02!:\xae;\x83]\nT\xa5\xa5\xcc\xee\xfb\x1d\xa6\x99\nZ\xaeL\xd8\xc7l\xd6\xe6\x9f{\n \x93q\xcfa\x9a\xf3\xb6\xf8\x85\xa29\xda/\x14dp\xdb\x85=>"\xd9\xc2~I7q\xc1\x06\xad\xd3\x83@\xaa5\xd0\xf5\x18\xee\x95\xc6\xe6n\xb4\xbel@\x95#?Z\xf3\xbd;\xe2\x07\xda\xdc\xfc\xe5G\xd6\xaf\'\x8cH\x1c\\q\xefY<?ce4\xd1\xda\x19\xad\\\xe5\x9f\x04z\x1ai\xb9\xb5\'f\xec\xe0w\xae:O\x19H\xb1\xeeGS\xefTf\xf1\xcbr|\xf5\xe0sY\xfb"\xb9\xd5\x8e\xda\xfa\xf6\xd4Bc\x8d\xb95\xcc\xea\xf1G#\x1d\xb2\xd7/\xa8|M\x86\r\xc1n\x00 VD\xbf\x16\xed\x02\xb1\x92pNz\xe2\xb5\x8d8\xc5{\xcc\xce\xf765M\x166\x97~\xe0Ee\\i\x10\xa3\x16nA\xf4\xac\x8b\xdf\x8b\xbav\xd2\xdb\xb7\x1f\xee\x8e\xf5\x95s\xf1F9Nc\x8f\xbf\x15\xcfR\xb5\x18\xb37v\xf4:x\xad\xa2A\xe5`b\x9e-"e1\xc6\x07\xd7\xd2\xb9$\xf1\xd5\xd5\xd3\x13\x10P\x07qWt\x9f\x12\xb3836I=\xeb\x8a\xadzM3H\xd3\x9bz\xa3\x93yP\x8d\xc4\x1c\x0e\xb9\xa8\xfe\xd4\x8a\xa5\xc3dz\x8a\x8a\xeaC\'\xc9\xb4\xaej\x94\xdb\xe3\xe1\x18\xf1\xd4W\r\x1eV>W\xb9\xa0\xb7\xb73|\xd1\xb7\xcbR\xc5h\xd7\x0e\x07\x98A\x07\x83\x9a\xcc\x82\xe8F\x0c\x8e6\x9e\xd8\xa1\xbcSol\xdb\xdaPq\xe9]\x94\xf4Vl\x1f4v:\x08\xfc&\xb7\r\xfb\xe9\xf3\x9e\xd9\xa5o\x87\xbe`\xccw\x0c=9\xac\x08\xbe$l\x9316\x7f\x1a\xbb\xff\x00\x0b^;8D\xd7\x97\x18\r\xf7B\x8c\x9a\xb7*\x11Z\x8a\xf2{\x97\'\xf8w\xa9F\xbb\xa1\xb9,>\x98\xc5g\\\xf8\x1bV\xb7\x93\xcc\x0f \xe7\xb5[\xb2\xf8\xd5\xa7\xdef\x18\\\x03\xdc\xc9\x13\n\xbc\x9e<[\xc5\r\n\xa3\xf1\xc8Z\xcf\xdaS\xbe\x8c\xabG\xa9\x8ct-V\x1e~\xd6\xc3\xeaj\xc5\x9e\xa3\xaaX\xbe\xc7r\xc3<U\xfb\x8f\x10\xc7p\x99xO\xcd\xf7O\xadT\xfbl$\xe5\xa2\\\xf7\xe2\xba\xe9UIh\xcc\xe4\x97C\xa0\xd1|M{3\x85b2+\xa9\xb6\x9a\xe2\xe9\x01\x0f\x93\x8e\x82\xb8}\x06h\xa5\xb8\x01\xb1\x8a\xef|.m\xb3\xb5\x88\xdc9\xc6k\xbe\x15/\x1d\xc4\xa3\xa0\xcb\xdb\x8b\xd8\xe0<\x1e+\x89\xf1\x07\x89u;Y\x9b;\x97\xe9^\x89\xafIh\xb6l]H;x \xd7\x98x\xa6X\xa4\xba;H\xc0\xf5\xaau\x12E%c&\xeb]\xba\xbb\x04\x19\x1b-U-\xecon\xe5\xda\x8e\xd9\'\xa15e\xd7s(T\r\x9a\x94\xddK\xa6\xca\xac\x8aI\xf4\nZ\xb8*\xd4Mj\xc2\xce[\x13Zx\x16\xf6\xed\xc1\x95\x88\x07\xa5lYx\x12\x15;g`q\xfd\xee\xb5\x9e\xfe+\xbd\xb3\x8a9"\xd1\xaen\xbc\xc3\x84\x8e\x06\x00\x93\xf8\xd2^x\xc3\xc5\xb6\x04=\xdf\xc3]b5n\x012\xa9\x1f\xa0\xaf2S\xa5\xcci\x184\x8d\xf8\xfc7\xa2\xdb\xf0UA\x00\xe4\x03I\x15\x96\x9f\x0c\xab\xe4F0O\xadc5\xff\x00\x89|\x8f\xb6\xcd\xe1-B\x18\xd9r^H\t\x03\xeai4\xedi\xd9\xc6UH<)\x1c\xf3Y\xcet\xd25\x82w)yfU\x07g\xcc*9t\xf9\xa7%\xb6\x8c\xe2\xaf\xc3\x19r\x01\x1c\x93\xc05\xa5o\xa5\xa0\x8f\xcds\xcf\xa05t\xe9\xcb\xa1\x93\x95\x91\xc7j\x1a\r\xf4\xd1\x11\x14X=\xba\xf3\\\xf5\xd7\x84\xb5\xcf<Gp\n\xa3\x11\x82\x018\xfc\xfaW\xac\xa5\x83\xb0\x00\x10\xa3=\x96\xa1\xbb\xd0\xa5\xb9#h\xfcH\xae\xa5Ji\x11\xccg\xf8\x03\xe1\x17\xc2\xcb\xbd\'\xcc\xf1E\xfd\xdb\\\x92:I\x8c\x0e\xfc\n\xa7\xe2\xdf\x08I\xe1\x1b\xa5\x9f\xc2\x11[\xdc\xc2\x1f\x08\xf2\xc5\xe6\x1f\xc8\xb5k\xa7\x85\xb5\x18\x9b|\x0c\x07\xb9&\xac\xff\x00a\xea\xee\xbb\x1e2Ob9\xc7\xbda:\r\x96\xa5\xdd\x9a\x7f\xb3\xef\x8d<a\xe2\x0f\x1bY\xe8>4\xd2\xf4%\xd2\xd6O\xdfI6\x85\x02\x920\x7f\x88\x82k\xeb\xddg\xc3\x7f\xb1\x9c\xbe\x18kmr\xe7\xc3\xd0M$|=\xad\xb9\x0e8\xed\xb5k\xe4\xad\x03\xc3\xfa\x9c\x1b]\xa1\x0b\xc7-\x8ekj+\x19P\x8f4\x83\x8e\xe4sYB\x8b\x8b-4W\xf8\x9f\xf0\xf7\xe1\xb6\x99\xac\xc8~\x1fk\x12^[n%\x0f\x92\xc0\x0f\xfb\xe8\xe6\xb8=GI\x82\xd8\xe4\x02\x1b\xd0\x8a\xef5;\x99Dn\xb0\xb6H\\\n\xe35X\xae\x9e\x7f6\xe6B=\x16\xbd*4]\x88\x94\xa0\xcc\xdb8\xfc\xa9\x8c\x91\xb9\x04z\n\xe9t=R\xea,L\xa4\x8c\x0cf\xb9\xe3\x02\xc7!u$g\xaf\xbdj\xe9\xd34j\x14\x9c\x8cW\xa5F\x94\x9a\xb2\xd0\xc1\xcf[#b\xfbQ\xbb\xbb\x81\x95\x9c\xf3\xd2\xb9\x1dJ\xd6F\x90\xf9\x9ds\xc6k\xa7\xf3\x04\x88\x03G\x91\xedY\xda\xad\xa3Jr\x10\x91\xdf\x02\xb5\xabA\xf2\x99\xaa\xa9nP\xd0\xac-\xbe\xd0\xabp\x01\xcbrG\xa5{w\xc3\x8d[\xe0\xe7\x87\xb4\xaf#X\xf0\xec\x93I \xf9\xa46\xea\xc0q\xf5\xaf\x15\x8a\xc1\xa2\x9c\x15l\x02{WY\xe1\xcb\xd8T\x98go\x94\x01\xb8\x9e\x95\xe5\xd6\xa1+X\xe8\x8dDP\xf8\xd1\xe1M;\\\xd6\x97W\xf8x\xd7\x10"\xc9\xb9\xa0L \xee;}j\xb7\xc2\xff\x00\x08\xf8\x86\xef\xc4\x90\xcf\xe3O\x19Me\xa7\xac\xc0\xc9\x1c\xae\\\xff\x00\xf5\xab\xb9\x8fC\xb3\xb9\x8f\xccI0\x18q\xb4\xd6>\xb3\xe0}E\xa4\xddkx\xdbO\xf0\x86\xeb^]L;\xe6:cv\xb4=\xfb\xc4\x7f\x1a>\x04xw\xc2?\xf0\x8dE\xac\xdaj2,%\x04im\xb8\xb9\xc7s\x8a\xf9\xcbP\xd0t-oX\x92\xfbJ\xd3\x92\xd9$\x90\xb2\xc4\x9d?,qL\xff\x00\x84\x1e\xe5e\xdb1 \xaf\xf1b\xb6\xb4M\x1aKP\n\x96lw"\xa7\xd8\xa6\xb6\r\x17S\xce\x1et\x89\xbc\xc45j\x0b\xff\x007n\xeeMe\xcbp\x19r\x07 \xd1\x15\xe8W\xder~\x95\xe8\xe1yy\x91\xcd\'i\x1dv\x9b4r\x80\x8a@\xfa\x8a\xd8\xb5\xb3V\x03*\x8d\x9e\x84\n\xe3t\xcb\xf3\xe6a\t\xc7z\xeb4\x8b\xc5\xf2\xd0\xb3s\x8e\xf5\xebF\x10h\xe6\xe6\xd7CJ\x0b\x04l\r\x83\xdcU\xe8\xa3\x8e\x15\x1ba^8\x04\xd3"h\xddF\xdc\x9e:\x8a\x99S\xa6F\xe3\xd8\x1ar\xa1\x19t6\x8c\xdf(\xbfj\\`E\x93\xdb\x15\x1bA-\xc1\xf92\t\xed\x8a\xb5ed\xf30\x12\xc1\x81\x9f\xc6\xb4\xe1\xb2\x86\xdf\x81\x1e8\xeaO"\xa1\xe1b\xb5)I\xf2\xdc\xe5\xeftiV2\xe7<u\xe2\xb9O\x14@\x8e\xbf62?\xbb]\xb7\x8c\xb5\x98\xb4\xeb/.0\x03>{\xd7\n\xc9>\xa9;*\x9c\xf3\xc8c[S\xa4\xb6G$\x9c\x93\xbd\xccX\xa13\x9d\xaa\t\xc7\xbdk\xe9\x1aU\xf5\xc3\x01\x1cD\xfb\xd6\xb5\x8f\x85\xf4\xebp%\x96E\xdd\xe9[\x1au\xde\x8d\xa4\x952<|z\x9a\xec\x858\xc3qE\xc9\x8d\xb2\xf0m\xec\xf0*\x8br\t\x1fx\n[\x9f\x04^*\x94hX\x1f\\Wi\xa1\xfcH\xf0LV\xe2\xde\xee\xe4+\x01\xd7\xcb\x04\x7f1Rj\x7f\x13|\x15kl\xeb\x03,\x85\x97\x8c\xa0\x1f\xd4\xd6\xfa2\x16\x87\x97\xdd\xf8R\xe6\xca\\\x98x^ph\xb5\xb6\x99$R# \x7ftv\xadMK\xc7:]\xed\xd1\xdb:|\xc7\x01O\x155\x9d\xd5\xa5\xc0\xca\x14\xfc\rr\xd5\xa3\x07\xa9\xac$\xd3\xb1&\x98\x97\xd1\x00\xdb\xf0;d\xd6\xb4\x17\xac\xcc\x16u\x00w5V\xd1RF\xda\xa3#\xda\xa5h\x82\x1f\x97\x1cz\xd7\x9dR\x84e#\xba\x12\xb2\xd0\xd2x\xedH\xdd\x1c\x83\x91\xc05J[\xa8m\xa4\xfb\xeb\x91\xdb5\x0b\xdc\x04\\ >\xe2\xb3\xb5&\x900p\xa0~5\x82\xc3\xa4\xf6\tK\x98\xf1\xf9\xa4&R\xbb\x08\x00\xe2\xa5\xb6\x8c\x06,_\x03\xb5@U\xdb\x01$\xc0\xedJ\xaeaRd\x90\x9e}+\xc9\xa3=\xaccQ\xdeW6,\xe7\x8d0\x08\xe4\x7f\x15l\xe9\x93\x97p\x19\xf6\x83\xfe\xd5r\xe9y\xe6cc\x10\x07\xf1zV\xb6\x97\xa8B\xa3\xe7py\xea+\xdc\xc3\xd5iY\x9c\xf2l\xeft\x9b\x98\xc2\x84c\x91\xda\xb6l\xfc\xb7e\xdb\x80;\xf1\\%\x8e\xb2aa\xb6BGj\xd5\xb5\xf13\x83\x81/\xe1]m\xa7\xd0\x86\xe4v\x91\\\xc5\x19\xc6\xe1\x91\xdcS\xa7\xd4\xa01\x95^I\x1d\x01\xae9<LFKH\xc3\xd4\x9aA\xe22[\x02Q\x83\xd0\xd3o\x99\x1b{G\x14V\xf8\x80\xf2\xcc\x8dq\x1fU\xe83\xd2\xbc\xfd\xfc]q\xa6\xc9\xe5\x08\xfebk\xd1o/\xado\x90\x89\xc89\x1c\xf3\\v\xb3\xe1\x9d\x15\xeeZvt\x00\xf4\x1e\x95.N$s9\x18\xd7\xbe3\xf1e\xc2\x96\xd2\x1cn#\xbb\x0c\x9f\xce\xb3\xa0\xb8\xf8\xb3~\x1d\xb5\x0bdE\xc9\xdac\x9d\t?\x86kR\xe1t\xebR<\x9e6\xf01R\xe9\xfa\xf8\xb5\x98&I\x07\xefqYK\x13\xd1\xb2\xfd\x9b\xb5\xcc\xbbC\xe2\xd8\x177\x1199\xf5\xabx\xf1\x05\xe0\xca\xccPw\xc09\xae\xae\xd2\xf6\x1b\xe5VH\xb3\xeb\x91Q\xea\x8c\xd0C\xba\xde\xdf\x07\xd4\n\x97\x8a}\x18B\x94nr\x17\x1a-\xee\xf3-\xc6\xa4\xc8\xc0dprj]#[\xf1\x06\x9br#\x86\xf5\x998\xe1\xba\x9a\x96\xea\xfcK9\xfbI\x19\x1d\x88\xab\x9aE\xce\x97\xe7\xe6FP\xd9\xe0T\xc7\x13\xcc\xec\xd9n\x11\xecw\xbe\x16\xd4\xaf\xde\xd1nn\xf2\xad\x8eT\x9e\xb5\xb0\xda\xbc\x0c\xc0\x93\xd4\xf3\x8a\xe4\xe0\xd5\xc1\xb7\xd9\x15\xca\xb0\xe3\xe5\x1d\xa8k\xb9\x14\xefY\x0e}1Z\xc6W\x1amt:\xb6\xd4m\xf2pk;S\xb8\x92PJI\x8e;\x9a\xc0\x9bU\x961\xbf\xed\x1cw\xc5W\x93]\xf3\x14\xaa1#\xde\xa5\xcb\x95\x03v\xd4\xe1 \x9c\x03\x8c\x9c\x83\xda\xa7\x9a\xe7\x1f1~\xbdk).\x9e%\x05\x9b\x93\xeaiZ\xfb<0\xcf\xe3_/Jw\xd4\xdd-,h\x9b\x90\x91~\xe5\xbeZ\xb3c~\xf1.\xf69\x07\xa0\xcdcEz\xca\x84\xb0\xc6?\x87547\xb1\xb1\x0cd\xc1\'\xa6k\xbe\x9ds\x19E\xa7\xa1\xd2A\xad0?x\xa8\xa9\x97[\n\xff\x00,\xdc\xe3\xbda5\xc0 m\xc6~\xb4,\xf1\xb19^\xfc\xf3]q\xc4wdJ-\x9d\nk\x9bN\x0c\x99\x18\xe9\xebO>"H\x17k\xc8\xbc\xd7/5\xfb\xc3\xf3D\xbcc\xa0\xaa\xadz\xf3I\x86%{\x90iO\x1a\xe3\xa2e\xa8\x9dM\xef\x8bg?*J:\x7f\reO\xaa^\xdf\xb0\xfd\xe1a\xe8{VlN\x8a\ti8\xcfCV \xd5-\xe1&5Q\x8f\\\xd7$\xb1U*u)$^\x8bJ\xb9\x9c\x82\xd1\x92OR\x0fJ\xd5\xd3\xfc"\xf7\x07&@\xa3\xd8\xd6m\xae\xafq\xb8}\x9e&`:\xe2\xb4\xec\xfcS\x1a7\xccJ\x91\xd4\x1a\x88\xb9^\xf7-\xab\xa3sK\xf0\xc5\xfd\xb8\xccS\xa3 \xeb\x9a\xb3.\x87y&VWU\x07\xbek6\xc7\xc5\xcc\xe7\x10\xb6\x7f\xd9\x15p\xf8\x96\xe4\xaf\xcf\x11#\xd0\xd5\xa9O\xa8*qh\xcc\xd4\xbc\r\x04\x8e\xd2\x19\xber8\xc1\xaeoT\xf0\xd5\xf6\x9f!*\xe0\x0f\xaduWZ\xed\xcd\xc0e\x82\xd5\xb7z\xa2\x92?J\xc3\xd5\xa5\xd7\xa7\x05\xfe\xc73c\xbf\x94@\xa8\x9c\x9a\xd4942\xad/u\x1b\x16\x08fb\t\xe9W\xd3\xc5R\xa9\xc3\xb9a\xe8Mf\xc8o\x94\xed\xba\xb3e-\xfcX\xe9ToR}\xbb\xd1X7J\x98\xe2\xaa\'\xa6\xc1\xec\xd3:\xa8\xf5\x85\xb8B\x0b\x8c\x1e\xde\x94\xd5\x9dB\x93\x92G\xa8\xef\\\x9d\x83\xea\x11J\x01f\x03\xd2\xb7\x12W\x11\x83+\xe3=9\xae\x88\xe2\xee\x8c\xe7\x06\xb68\xab\rL\\&\xe9\x9b#\xb0\xf4\xabk&\xf2X\x0c\x0e\xb95\xc5\xf8gY\x9a@\x14.@\xecz\x8a\xde\x1a\xc2\xc4\t\xe0\x9fs^\r,Decf\xb56D\xa1\xc7\xcb\xc9\xf5\xa4\x13yc\xe4<\xe7\x9a\xcdMQ_\x05N3\xefS\x1dJ%;\xb0\x7f\x1a\xedU\x1abr\xb34\xed\xae\x9eO\x90\xc8x\xee:\xd5\x88\xae&\xd8T\xcb\x9fLV!\xd5pwF:\xf5\xa9`\xd4\x1eU\xc8\xfeu\xaf\xb5\xd3R#\xa9\xb4\'\x8c \xdc}\xceMD\xcd\x11\x90\xb4l2}\xea\x9csd\xee-\xf9T\xa8\xf1\x90\x0fA\x9e\xb8\xcde:\x8al\xad\xf6.i\xf6p\xdcK\x86\x93\xef\x1eNk\xa5\xb0\xf0\xc6\x90#\x0e\xb2\x86\xfe\xf0\xaeInA\xff\x00V\xdbpx\x18\xebO\xff\x00\x84\x92\xf2\xc9s\xe7\x11\x8at\xe5\x04\xf5\x08\xb3\xd6\xbc\x1d\xa1i\xb1\xba\x95\x89J\xf5\x1b\xd4W\xa2\xe9zW\x85n\xd1Rm\n\xce@F\x18\xb5\xb8&\xbey\xd1~-}\x89\x0cR\xcd\xc6:\xb5u\x1a\x07\xc6\xdb{k\x85\x1f\xda\x01x\xcb\x8d\xdf\xad{\x98ia\xa4\xd2e\xc6I=Ov\x83\xe1?\xc3\xadJ\r\xff\x00\xf0\x88\xdb\x82z\xb0$~\x80P\xbf\x04<\x0e\xaf\x9bM\'\xcb8\xe0c#\xf5\xaeK\xc3\x7f\xb4f\x81\x1d\xb0\x13\xdd\xc2\xc4\x0cd\xb8\xc9\xab\x93~\xd2^\x1d\x8dw%\xd4J\xd9\xff\x00\x9e\xa2\xbd\x15\x0c3\xd9#U\xca\xcd\xfb\xdf\x86\xdaf\x8dnJY\xc3\xc0\xc8!Fk\x8a\xf1\x10\xb0\x8d\xcc,\x80`\x9cd\n<A\xfbK\xe8w\x16\xe6\x04\xba\x8bq\xfe"\xe2\xbc\x9f\xc5_\x18\x96\xea\xe5\xda\x19\x84\x8a\xdd\x00\xed\\\xf5\x16\x1e\t\xde\xc3\x93V:}~\xe2\xc0DM\xccq\x1c\x9c\x02@\xcdpZ\xcc\xd6Fv\xf2W\x00\x1a\xc6\xd4<iq{6\xe9\xd9\x899\xdas\xd2\xa2K\xf12n\x19\xcf\xa9\xaf\x9e\xc4T\x83\x97\xbb\xb1\xce\xe5sAoR%\xc8\xc7\xb6i\x1bQi\x08\x04\x8d\xbd\xf9\xac\xc39~Y\xcf\x07\xa8\xa9Vu#v3\x8er\rc\xce\x92\x0b\xf3-O4\xf0b\xb3J\xc8\x99\xdckkQ\xb5\x9a\xdd\xbc\xd6\x07\x07\xae+/\xc0\x1b\x1a\xed\xd5\xa3\xf9\x80\xe0\xd7O4>b>G>\xf5\xe1\xd1\xda\xe6\x92Vf%\xbd\xec\x90\xc9\xb81\x03\xd2\xb4\xa1\xd4#\x91p\xed\xf8\xd4\x17\x1aT\x8c\x85\xb6\x81\x8e\xb8\xac\x8b\xa6\xbb\xb4\x90\xed\'h\xe8k\xaa5\xa6\x89{\x9d*\xc9\x1a\x00A\xce{\xe6\xa5\x8eh\xcb\xf0\xd8\xf5\xaeN\xdfV\xba\x8d\xf7J\xd9\x03\x90+F\rg\xed\n\t\x93\x18\xadUn\xe2\xe5\xb1\xd2[\xdf\x05\xe1\x08\xc9<\x01W#\xbag\xe06=\xab\x94\x1a\xa3\xfd\xe0@\x1d\x8f\xad^\xb4\xd7\xd67\x1ea\xcf\xb0\xad\x95[\xec\x1a\x9d\t/\xf7\x95H\xf5\xa4k_<e\x89\xc7zm\xa6\xa3g<a\xcb\xe0\x91\xd0\x9a\xb5\x14\xb6\x8d\xc6\xf5?J\xd6\r=\xc2>eht\x08\xe6| \xe3\x1dsV\xa3\xf0j\xb8;\x0b\xe7\x1d\x8dZ\xb2\xb8\xb4\x80\x9f(d\xe2\xae\xc3\xae\xc1\n\x9f\x98\x03\xe9\x9a\xea\x82I]\x15f\xcc\x99\xbc\x02\xb2G\xf3L\xdf\x89\xaa\xed\xf0\xf9"O1[\xe8A\xad\xe9<Sj\x0e7\xa9>\x9b\xa9\xa7\\\x8e\xe3\x05d\x0b\xcfJ\xb7V[\\\x15\xd30\xff\x00\xe1\x12\x91Xd\xb6\x07bh_\x0e\xdb\xab\xb0+\x93\xf5\xad\xab\xcdMDc\x0e1\xde\xa8\xcb\xa9D\t\xc9\xc5d\xe7\xcd\xbb\x1b\x92E\x1f\xec\x84/\xb4C\x81\xebP]J\xb6\x1c\x9e=3Wnu\xfb{X\xb1\xbcg\xb5s~"\xd7|\xeeU\xb2q\xd2\xb8\xebU\x8cv\x15\x92\xd4\xb5.\xb1\x18<\x81\xef\x83T\xaf<PaV[prG\xe5X\x92jR\xcaI\x8d\xc8#\xaeMC\xf6\x87\xf2\xca\xba\xe7>\xfdk\xcf\x9e-\xa4\xd1j.G\xff\xd9'
  
  certificate = (
    CertificateBuilder()
    .subject_name(subject)
    .issuer_name(issuer)
    .public_key(public_key)
    .serial_number(random_serial_number())
    .not_valid_before(datetime.datetime.now(datetime.UTC))
    .not_valid_after(datetime.datetime.now(datetime.UTC) + datetime.timedelta(days=365*3))
    .add_extension(
      KeyUsage(
        digital_signature=True,
        content_commitment=True,
        key_encipherment=False,
        data_encipherment=False,
        key_agreement=False,
        key_cert_sign=False,
        crl_sign=False,
        encipher_only=False,
        decipher_only=False
      ),
      critical=True
    )
    .add_extension(
      SubjectAlternativeName([
        RFC822Name(EMAIL_ADDRESS),
      ]), critical=False
    )
    .sign(private_key, hashes.SHA256(), default_backend())
  )

  encryption = (
    PrivateFormat.PKCS12.encryption_builder().
    kdf_rounds(50000).
    key_cert_algorithm(pkcs12.PBES.PBESv1SHA1And3KeyTripleDESCBC).
    hmac_hash(hashes.SHA256()).build(f"{digit}".encode())
  )

  p12 = pkcs12.serialize_key_and_certificates(
    f"{COMMON_NAME}".encode(), private_key, certificate, None, encryption
  )

  return p12, base64.b64encode(
    certificate.public_bytes(
      serialization.Encoding.PEM)
    ).decode('utf-8') , base64.b64encode(
      private_key.private_bytes(
        encoding=serialization.Encoding.PEM,
        format=serialization.PrivateFormat.TraditionalOpenSSL,
        encryption_algorithm=serialization.NoEncryption()
      )
    ).decode('utf-8'), base64.b64encode(
      public_key.public_bytes(
        encoding=serialization.Encoding.PEM,
        format=serialization.PublicFormat.SubjectPublicKeyInfo,
      )
    ).decode('utf-8'), digit